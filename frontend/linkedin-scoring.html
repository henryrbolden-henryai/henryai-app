<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Scoring ‚Äî HenryHQ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #0a0a0b;
            --color-surface: #141416;
            --color-surface-elevated: #1c1c1f;
            --color-border: rgba(255, 255, 255, 0.08);
            --color-border-hover: rgba(255, 255, 255, 0.15);
            --color-text: #fafafa;
            --color-text-secondary: #a1a1aa;
            --color-accent: #22d3ee;
            --color-accent-muted: rgba(34, 211, 238, 0.15);
            --color-success: #4ade80;
            --color-warning: #fbbf24;
            --color-error: #f87171;
            --color-linkedin: #0077b5;
            --font-display: 'Instrument Serif', Georgia, serif;
            --font-body: 'DM Sans', -apple-system, sans-serif;
            --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--color-bg);
            color: var(--color-text);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* Main content */
        main {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .back-link {
            color: var(--color-text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 24px;
        }

        .back-link:hover {
            color: var(--color-accent);
        }

        h1 {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 400;
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 1.1rem;
            margin-bottom: 40px;
        }

        /* Score Card */
        .score-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
        }

        .score-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 24px;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(var(--color-linkedin) calc(var(--score) * 3.6deg), var(--color-surface-elevated) 0deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--color-surface);
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--color-linkedin);
        }

        .score-info h2 {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 8px;
        }

        .score-label {
            color: var(--color-text-secondary);
            font-size: 0.95rem;
        }

        /* Upload State */
        .upload-prompt {
            background: var(--color-surface);
            border: 2px dashed var(--color-border);
            border-radius: 16px;
            padding: 48px 32px;
            text-align: center;
            margin-bottom: 24px;
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .upload-prompt h2 {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 12px;
        }

        .upload-prompt p {
            color: var(--color-text-secondary);
            margin-bottom: 24px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .upload-how-to {
            background: var(--color-surface-elevated);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            display: inline-block;
        }

        .upload-how-to strong {
            color: var(--color-text);
        }

        .upload-path {
            color: var(--color-text-secondary);
            font-size: 0.9rem;
            display: block;
            margin-top: 8px;
        }

        .btn-primary {
            padding: 14px 28px;
            background: var(--color-linkedin);
            border: none;
            border-radius: 8px;
            color: white;
            font-family: var(--font-body);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s var(--ease-out), box-shadow 0.2s var(--ease-out);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 119, 181, 0.3);
        }

        /* Real Talk Banner */
        .real-talk {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-left: 3px solid var(--color-accent);
            border-radius: 8px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .real-talk h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-accent);
            margin-bottom: 8px;
        }

        .real-talk p {
            color: var(--color-text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 0;
        }

        .real-talk strong {
            color: var(--color-text);
        }

        /* Score Breakdown */
        .breakdown-section {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .breakdown-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .breakdown-item {
            background: var(--color-surface-elevated);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 3px solid var(--color-border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .breakdown-item:last-child {
            margin-bottom: 0;
        }

        .breakdown-item:hover {
            border-left-color: var(--color-accent);
        }

        .breakdown-item.success {
            border-left-color: var(--color-success);
        }

        .breakdown-item.warning {
            border-left-color: var(--color-warning);
        }

        .breakdown-item.error {
            border-left-color: var(--color-error);
        }

        .breakdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .breakdown-label {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .breakdown-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .breakdown-icon.success {
            background: rgba(74, 222, 128, 0.15);
        }

        .breakdown-icon.warning {
            background: rgba(251, 191, 36, 0.15);
        }

        .breakdown-icon.error {
            background: rgba(248, 113, 113, 0.15);
        }

        .breakdown-label-text {
            font-weight: 600;
            font-size: 1rem;
        }

        .breakdown-score {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .breakdown-score.success {
            color: var(--color-success);
        }

        .breakdown-score.warning {
            color: var(--color-warning);
        }

        .breakdown-score.error {
            color: var(--color-error);
        }

        .breakdown-why {
            color: var(--color-text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 12px;
            padding-left: 44px;
        }

        .breakdown-what-recruiters-see {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 14px 16px;
            margin-left: 44px;
        }

        .breakdown-what-recruiters-see strong {
            display: block;
            color: var(--color-text);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .breakdown-what-recruiters-see p {
            color: var(--color-text-secondary);
            font-size: 0.85rem;
            line-height: 1.5;
            margin: 0;
        }

        .breakdown-what-recruiters-see ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .breakdown-what-recruiters-see li {
            color: var(--color-text-secondary);
            font-size: 0.85rem;
            padding: 4px 0;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }

        .breakdown-what-recruiters-see li::before {
            content: '‚Üí';
            color: var(--color-accent);
            flex-shrink: 0;
        }

        /* Recommendations */
        .recommendations-list {
            list-style: none;
        }

        .recommendation-item {
            padding: 16px;
            background: var(--color-surface-elevated);
            border-radius: 8px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
        }

        .recommendation-priority {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: rgba(248, 113, 113, 0.15);
            color: var(--color-error);
        }

        .priority-medium {
            background: rgba(251, 191, 36, 0.15);
            color: var(--color-warning);
        }

        .recommendation-text {
            flex: 1;
        }

        .recommendation-text strong {
            display: block;
            margin-bottom: 4px;
        }

        .recommendation-text p {
            color: var(--color-text-secondary);
            font-size: 0.9rem;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            border: 3px solid var(--color-surface-elevated);
            border-top: 3px solid var(--color-linkedin);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="stylesheet" href="css/linkedin.css">
    <!-- Supabase Auth -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>
</head>
<body>
    <main>
        <a href="results.html" class="back-link">‚Üê Back to Results</a>

        <h1>LinkedIn Scoring</h1>
        <p class="subtitle" id="subtitle">Analyze your LinkedIn profile's effectiveness for this role</p>

        <!-- Content will be rendered dynamically -->
        <div id="mainContent">
            <!-- Upload Prompt (shown when no LinkedIn) -->
            <div class="upload-prompt" id="uploadPrompt">
                <div class="upload-icon">üíº</div>
                <h2>Upload Your LinkedIn Profile</h2>
                <p>Get a detailed score and recommendations to optimize your LinkedIn for recruiter visibility and job fit.</p>

                <div class="upload-how-to">
                    <strong>How to get your LinkedIn PDF:</strong>
                    <span class="upload-path">LinkedIn.com ‚Üí Your Profile ‚Üí More ‚Üí Save to PDF</span>
                </div>

                <button class="btn-primary" id="uploadBtn">Upload LinkedIn Profile PDF</button>
                <input type="file" id="linkedinFile" accept=".pdf" style="display: none;">
            </div>

            <!-- Score Card (shown when LinkedIn uploaded) -->
            <div id="scoreContent" style="display: none;">
                <!-- Real Talk Banner -->
                <div class="real-talk">
                    <h3>Real Talk: How Recruiters Use LinkedIn</h3>
                    <p>You've got <strong>6‚Äì10 seconds</strong> to look "worth opening." Recruiters aren't reading your whole profile at first‚Äîyour headline, current role, and last company do most of the work. This score helps you optimize for that first impression.</p>
                </div>

                <div class="score-card">
                    <div class="score-header">
                        <div class="score-circle" style="--score: 75">
                            <span class="score-value" id="overallScore">75</span>
                        </div>
                        <div class="score-info">
                            <h2 id="scoreLabel">Good Profile</h2>
                            <p class="score-label" id="scoreSummary">Your LinkedIn profile is well-optimized but has room for improvement.</p>
                        </div>
                    </div>
                </div>

                <!-- Breakdown -->
                <div class="breakdown-section">
                    <h3 class="breakdown-title">üìä What Recruiters Are Looking At</h3>
                    <div id="breakdownItems">
                        <!-- Populated dynamically -->
                    </div>
                </div>

                <!-- Recommendations -->
                <div class="breakdown-section">
                    <h3 class="breakdown-title">üéØ Your Action Items</h3>
                    <ul class="recommendations-list" id="recommendationsList">
                        <!-- Populated dynamically -->
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <script>
        const API_BASE = window.location.hostname === 'localhost' ? 'http://localhost:8000' : 'https://henryai-app-production.up.railway.app';

        // Check if LinkedIn profile is already uploaded
        document.addEventListener('DOMContentLoaded', async () => {
            const profile = JSON.parse(localStorage.getItem('userProfile') || '{}');

            if (profile.linkedin_profile_uploaded) {
                showScoreContent();
                await loadLinkedInScore();
            } else {
                showUploadPrompt();
            }
        });

        function showUploadPrompt() {
            document.getElementById('uploadPrompt').style.display = 'block';
            document.getElementById('scoreContent').style.display = 'none';
        }

        function showScoreContent() {
            document.getElementById('uploadPrompt').style.display = 'none';
            document.getElementById('scoreContent').style.display = 'block';
        }

        // File upload handling
        document.getElementById('uploadBtn').addEventListener('click', () => {
            document.getElementById('linkedinFile').click();
        });

        document.getElementById('linkedinFile').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            // Show loading
            document.getElementById('uploadPrompt').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing your LinkedIn profile...</p>
                </div>
            `;

            try {
                const formData = new FormData();
                formData.append('file', file);

                const response = await fetch(`${API_BASE}/api/linkedin/upload`, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Upload failed');
                }

                const data = await response.json();

                // Update local profile
                let profile = JSON.parse(localStorage.getItem('userProfile') || '{}');
                profile.linkedin_profile_uploaded = true;
                profile.linkedin_last_updated = new Date().toISOString();
                profile.linkedin_parsed = data.parsed_data;
                localStorage.setItem('userProfile', JSON.stringify(profile));

                // Show score
                showScoreContent();
                await loadLinkedInScore();

            } catch (error) {
                console.error('Upload error:', error);
                alert('Failed to upload LinkedIn profile. Please try again.');
                showUploadPrompt();
            }
        });

        async function loadLinkedInScore() {
            const analysisData = JSON.parse(sessionStorage.getItem('analysisData') || '{}');
            const profile = JSON.parse(localStorage.getItem('userProfile') || '{}');

            // Generate score based on profile completeness and job alignment
            const score = calculateLinkedInScore(profile, analysisData);
            displayScore(score);
        }

        // Detailed coaching content for each breakdown category
        const BREAKDOWN_COACHING = {
            titleScope: {
                label: 'Title + Scope',
                why: 'Recruiters don\'t care about fancy words. They\'re looking at your level, the size of what you owned, and whether you\'ve done the job before.',
                whatRecruitersSee: [
                    'Not the title itself‚Äîthe scope behind it',
                    'Team size, budget, revenue responsibility',
                    'Individual contributor vs manager vs director',
                    'Whether your level matches what they\'re hiring for'
                ]
            },
            careerStory: {
                label: 'Career Story',
                why: 'Your progression either makes sense or it doesn\'t. Recruiters are pattern-matching your trajectory to predict your next move.',
                whatRecruitersSee: [
                    'Progression: Did you grow or move laterally?',
                    'Lateral hops get side-eyed‚Äîwhy\'d you move?',
                    'Gaps longer than 6 months need context',
                    'The story your moves tell about your ambition'
                ]
            },
            companyQuality: {
                label: 'Company Quality',
                why: 'Name recognition, scale, and relevance to the role all matter. Working at a known company is social proof‚Äîit means someone else already vetted you.',
                whatRecruitersSee: [
                    'Brand recognition of your employers',
                    'Company scale and growth stage',
                    'Industry relevance to the target role',
                    'Whether you\'ve worked in similar environments'
                ]
            },
            tenure: {
                label: 'Tenure Patterns',
                why: 'Too short everywhere looks risky‚Äîwill you leave in 6 months? Too long everywhere can look stale‚Äîare you still growing? Balance matters.',
                whatRecruitersSee: [
                    'Average time at each company',
                    'Recent short stints (< 1 year) are red flags',
                    '2-4 years is the sweet spot for most roles',
                    'Long tenure (5+ years) needs visible growth'
                ]
            },
            keywords: {
                label: 'Skills Alignment',
                why: 'Keywords matter for search, but context matters more. Recruiters use Boolean searches to find candidates‚Äîif your skills aren\'t there, you\'re invisible.',
                whatRecruitersSee: [
                    'Do your skills match what they\'re searching for?',
                    'Are keywords in context or just listed?',
                    'Technical skills validated by experience',
                    'Industry-specific terminology they expect'
                ]
            },
            activitySignals: {
                label: 'Activity Signals',
                why: '"Open to Work," recent updates, and profile freshness signal intent. Recruiters filter for people who look like they\'re actually open to moving.',
                whatRecruitersSee: [
                    'Open to Work badge (visible to recruiters only)',
                    'Profile updated in last 90 days',
                    'Recent activity: posts, comments, shares',
                    'Complete profile = serious candidate'
                ]
            }
        };

        function calculateLinkedInScore(profile, analysisData) {
            const linkedinData = profile.linkedin_parsed || {};
            const resumeData = analysisData._resume_json || {};

            // Score components (out of 100 each, 6 categories)
            let titleScopeScore = 0;
            let careerStoryScore = 0;
            let companyQualityScore = 0;
            let tenureScore = 0;
            let keywordsScore = 0;
            let activityScore = 0;

            // Title + Scope (17 points max)
            if (linkedinData.headline && linkedinData.headline.length > 20) titleScopeScore += 5;
            if (linkedinData.experience?.length > 0) {
                const currentRole = linkedinData.experience[0];
                if (currentRole.title) titleScopeScore += 4;
                if (currentRole.description && currentRole.description.length > 100) titleScopeScore += 4;
                if (currentRole.company) titleScopeScore += 4;
            }

            // Career Story (17 points max)
            const expCount = linkedinData.experience?.length || 0;
            if (expCount >= 3) careerStoryScore += 8;
            else if (expCount >= 2) careerStoryScore += 5;
            else if (expCount >= 1) careerStoryScore += 3;

            // Check for progression (simplified)
            if (linkedinData.summary && linkedinData.summary.length > 200) careerStoryScore += 5;
            if (linkedinData.education?.length > 0) careerStoryScore += 4;

            // Company Quality (17 points max) - simplified scoring
            if (linkedinData.experience?.length > 0) {
                const hasCompanyDescriptions = linkedinData.experience.some(e => e.company_description?.length > 50);
                if (hasCompanyDescriptions) companyQualityScore += 8;
                companyQualityScore += Math.min(9, linkedinData.experience.length * 3);
            }

            // Tenure Patterns (17 points max)
            if (linkedinData.experience?.length > 0) {
                const hasMultiYearRoles = linkedinData.experience.some(e => {
                    const dates = e.dates || '';
                    return dates.includes('year') || dates.includes('Present');
                });
                if (hasMultiYearRoles) tenureScore += 10;
                tenureScore += Math.min(7, linkedinData.experience.length * 2);
            }

            // Skills Alignment (17 points max)
            const atsKeywords = analysisData.ats_keywords || analysisData.required_skills || [];
            const skillCount = linkedinData.skills?.length || 0;
            if (skillCount >= 10) keywordsScore += 8;
            else if (skillCount >= 5) keywordsScore += 5;
            else if (skillCount >= 1) keywordsScore += 2;

            if (atsKeywords.length > 0 && linkedinData.summary) {
                const summaryLower = (linkedinData.summary + ' ' + (linkedinData.headline || '')).toLowerCase();
                const matchingKeywords = atsKeywords.filter(kw => summaryLower.includes(kw.toLowerCase()));
                keywordsScore += Math.min(9, Math.round((matchingKeywords.length / atsKeywords.length) * 9));
            } else {
                keywordsScore += 4;
            }

            // Activity Signals (15 points max)
            if (profile.linkedin_last_updated) {
                const lastUpdated = new Date(profile.linkedin_last_updated);
                const daysSinceUpdate = (Date.now() - lastUpdated) / (1000 * 60 * 60 * 24);
                if (daysSinceUpdate < 30) activityScore = 15;
                else if (daysSinceUpdate < 90) activityScore = 12;
                else if (daysSinceUpdate < 180) activityScore = 8;
                else activityScore = 4;
            } else {
                activityScore = 10;
            }

            const overall = Math.round(titleScopeScore + careerStoryScore + companyQualityScore + tenureScore + keywordsScore + activityScore);

            return {
                overall,
                breakdown: {
                    titleScope: {
                        score: titleScopeScore,
                        max: 17,
                        ...BREAKDOWN_COACHING.titleScope
                    },
                    careerStory: {
                        score: careerStoryScore,
                        max: 17,
                        ...BREAKDOWN_COACHING.careerStory
                    },
                    companyQuality: {
                        score: companyQualityScore,
                        max: 17,
                        ...BREAKDOWN_COACHING.companyQuality
                    },
                    tenure: {
                        score: tenureScore,
                        max: 17,
                        ...BREAKDOWN_COACHING.tenure
                    },
                    keywords: {
                        score: keywordsScore,
                        max: 17,
                        ...BREAKDOWN_COACHING.keywords
                    },
                    activitySignals: {
                        score: activityScore,
                        max: 15,
                        ...BREAKDOWN_COACHING.activitySignals
                    }
                },
                recommendations: generateRecommendations(titleScopeScore, careerStoryScore, companyQualityScore, tenureScore, keywordsScore, activityScore, linkedinData)
            };
        }

        function generateRecommendations(titleScope, careerStory, companyQuality, tenure, keywords, activity, linkedinData) {
            const recommendations = [];

            // Title + Scope recommendations
            if (titleScope < 12) {
                recommendations.push({
                    priority: 'high',
                    title: 'Strengthen Your Headline',
                    text: 'Your headline is prime real estate. Include your level, specialty, and what you\'re known for‚Äînot just your job title. Recruiters decide in 3 seconds if you\'re worth clicking.'
                });
            }

            // Career Story recommendations
            if (careerStory < 12) {
                recommendations.push({
                    priority: 'high',
                    title: 'Tell Your Career Story',
                    text: 'Add a summary that connects the dots. Why did you make each move? What\'s the thread? Recruiters are pattern-matching‚Äîhelp them see your trajectory.'
                });
            }

            // Company Quality recommendations
            if (companyQuality < 10) {
                recommendations.push({
                    priority: 'medium',
                    title: 'Add Company Context',
                    text: 'Not everyone knows your past employers. Add brief company descriptions: size, industry, what they\'re known for. This gives your experience context and credibility.'
                });
            }

            // Tenure recommendations
            if (tenure < 10) {
                recommendations.push({
                    priority: 'medium',
                    title: 'Address Tenure Concerns',
                    text: 'If you have short stints, add context in your descriptions. Acquisitions, restructures, and contract roles are valid‚Äîbut recruiters won\'t know unless you tell them.'
                });
            }

            // Keywords recommendations
            if (keywords < 12) {
                recommendations.push({
                    priority: 'high',
                    title: 'Optimize for Recruiter Search',
                    text: 'Recruiters use Boolean search to find candidates. Make sure your target skills appear in your headline, summary, AND experience sections‚Äînot just your skills list.'
                });
            }

            // Activity recommendations
            if (activity < 12) {
                recommendations.push({
                    priority: 'medium',
                    title: 'Signal You\'re Open',
                    text: 'Turn on "Open to Work" (visible to recruiters only). Update your profile this week. Recent activity signals intent‚Äîand recruiters filter for it.'
                });
            }

            // Add specific tactical recommendations
            if (!linkedinData?.headline || linkedinData.headline.length < 30) {
                recommendations.push({
                    priority: 'high',
                    title: 'Expand Your Headline',
                    text: 'You have 220 characters‚Äîuse them. Format: "[Level] [Role] | [Specialty] | [What you\'re known for]". Example: "Senior Product Manager | B2B SaaS | Scaled products from 0-1"'
                });
            }

            if (!linkedinData?.summary || linkedinData.summary.length < 200) {
                recommendations.push({
                    priority: 'high',
                    title: 'Write a Real Summary',
                    text: 'Your About section should answer: What do you do? What are you great at? What are you looking for? Write it in first person‚Äîbe human, not a robot.'
                });
            }

            return recommendations;
        }

        function displayScore(scoreData) {
            const { overall, breakdown, recommendations } = scoreData;

            // Update overall score
            document.getElementById('overallScore').textContent = overall;
            document.querySelector('.score-circle').style.setProperty('--score', overall);

            // Set score label
            let label, summary;
            if (overall >= 80) {
                label = 'Strong Profile';
                summary = 'You\'re showing up well in recruiter searches. A few tweaks could make you stand out even more.';
            } else if (overall >= 60) {
                label = 'Good Foundation';
                summary = 'Recruiters can find you, but you\'re not standing out yet. Focus on the items below to level up.';
            } else if (overall >= 40) {
                label = 'Needs Work';
                summary = 'You\'re likely getting filtered out of recruiter searches. Address the high-priority items first.';
            } else {
                label = 'Invisible to Recruiters';
                summary = 'Your profile isn\'t optimized for how recruiters actually search. Let\'s fix that.';
            }

            document.getElementById('scoreLabel').textContent = label;
            document.getElementById('scoreSummary').textContent = summary;

            // Render breakdown with coaching content
            const breakdownContainer = document.getElementById('breakdownItems');
            breakdownContainer.innerHTML = Object.entries(breakdown).map(([key, item]) => {
                const percentage = Math.round((item.score / item.max) * 100);
                let status, icon;
                if (percentage >= 80) {
                    status = 'success';
                    icon = '‚úì';
                } else if (percentage >= 50) {
                    status = 'warning';
                    icon = '!';
                } else {
                    status = 'error';
                    icon = '‚úó';
                }

                // Build the "What Recruiters See" list
                const whatRecruitersSeeHTML = item.whatRecruitersSee
                    ? item.whatRecruitersSee.map(point => `<li>${point}</li>`).join('')
                    : '';

                return `
                    <div class="breakdown-item ${status}">
                        <div class="breakdown-header">
                            <div class="breakdown-label">
                                <div class="breakdown-icon ${status}">${icon}</div>
                                <span class="breakdown-label-text">${item.label}</span>
                            </div>
                            <span class="breakdown-score ${status}">${item.score}/${item.max}</span>
                        </div>
                        <p class="breakdown-why">${item.why || ''}</p>
                        ${whatRecruitersSeeHTML ? `
                            <div class="breakdown-what-recruiters-see">
                                <strong>What Recruiters Check</strong>
                                <ul>${whatRecruitersSeeHTML}</ul>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');

            // Render recommendations
            const recommendationsContainer = document.getElementById('recommendationsList');
            if (recommendations.length > 0) {
                recommendationsContainer.innerHTML = recommendations.map(rec => `
                    <li class="recommendation-item">
                        <span class="recommendation-priority priority-${rec.priority}">${rec.priority}</span>
                        <div class="recommendation-text">
                            <strong>${rec.title}</strong>
                            <p>${rec.text}</p>
                        </div>
                    </li>
                `).join('');
            } else {
                recommendationsContainer.innerHTML = `
                    <li class="recommendation-item" style="background: rgba(74, 222, 128, 0.1); border-left: 3px solid var(--color-success);">
                        <div class="recommendation-text">
                            <strong style="color: var(--color-success);">You\'re in great shape</strong>
                            <p>Your LinkedIn profile is well-optimized. Keep it fresh by updating every 90 days and engaging with content in your industry.</p>
                        </div>
                    </li>
                `;
            }
        }
    </script>

    <script src="components/ask-henry.js"></script>
    <script src="components/strategy-nav.js"></script>
    <script src="components/status-banner.js"></script>
    <script src="js/linkedin-upload.js"></script>
</body>
</html>
